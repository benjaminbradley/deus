<div id="voting"></div>
<script type="text/javascript" src="/plugin/cue/js/stages.js">
</script>
<script type="text/javascript" src="/plugin/cue/js/ouroboros.js">
</script>
<script type="text/javascript" src="/plugin/cue/js/cue-view.js">
</script>
<script>
  function render() {
    
    var cues = [];
    {{#nextcues}}
    cues.push('{{id}}');
    {{/nextcues}}
    
    $('.help').hide();

    var canvas = document.getElementById("cue-canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    var stage = new createjs.Stage("cue-canvas");
    stage.autoClear = true;
    ouroborus = new deus.ouroboros.Ouroboros(cues); 
    var elements = [
      ouroborus,
    ];
    var i;
    for(i = 0; i < elements.length; i++) {
      elements[i].add(stage);  
    }
    ouroborus.enbiggen();
    
    createjs.Ticker.addEventListener("tick", handleTick);
    function handleTick(event) {
      for(i = 0; i < elements.length; i++) {
        elements[i].draw(stage);  
      }
      stage.update();
    }
  }

  $.get("/e/{{shortname}}", function(response) {
    $('#voting').html(response);
    render();
  });
</script>
